policies:

  - name: ec2-tag-compliance
    resource: ec2
    comment: |-
      Report on total count of non compliant instances
    filters:
    - or:
      - tag:Environment: absent

  - name: lambda-tag-compliance
    resource: lambda
    comment: |-
      Report on total count of non compliant instances
    filters:
    - or:
      - tag:Environment: absent

  - name: sqs-tag-compliance
    resource: sqs
    comment: |-
      Report on total count of non compliant instances
    filters:
      - or:
          - tag:Environment: absent
    actions:
      - type: tag
        tags:
          Environment: DTS

  - name: sns-tag-compliance
    resource: sns
    comment: |-
      Autotag SNS resources with its creator.
    mode:
      type: cloudtrail
      role: arn:aws:iam::891377226793:role/AppfireCloudCustodian
      events:
        - source: sns.amazonaws.com
          event: CreateTopic
          ids: "requestParameters.name"
    filters:
      - tag:CreatorName: absent
    actions:
      - type: auto-tag-user
        tag: CreatorName
