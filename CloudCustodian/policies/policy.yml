policies:

  - name: ec2-tag-compliance
    resource: ec2
    comment: |-
      Report on total count of non compliant instances
    filters:
    - or:
      - tag:Environment: absent

  - name: lambda-tag-compliance
    resource: lambda
    comment: |-
      Report on total count of non compliant instances
    filters:
    - or:
      - tag:Environment: absent

  - name: sqs-tag-compliance
    resource: sqs
    comment: |-
      Report on total count of non compliant instances
    filters:
      - or:
          - tag:Environment: absent
    actions:
      - type: tag
        tags:
          Environment: DTS

  - name: sns-tag-compliance
    resource: sns
    comment: |-
      Autotag SNS resources with its creator.
    mode:
      type: cloudtrail
      events:
        - CreateTopic
    actions:
      - type: tag
        key: Creator
        value_from:
          expression: "event.userIdentity.arn"
